<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd             http://camel.apache.org/schema/spring            http://camel.apache.org/schema/spring/camel-spring.xsd">
    <routeContext id="routeBS10_SignPage" xmlns="http://camel.apache.org/schema/spring">
        <route id="_route1">
            <from id="_from1" uri="direct:bs_10"/>
            <log id="_log1" message="Hello World BS10 at ${date:now}"/>
            <setProperty id="_setProperty1" propertyName="timestamp">
                <simple resultType="java.lang.Long">
        			${date:now}
        		</simple>
            </setProperty>
            <!--      		Checkpoint request accepted -->
            <wireTap id="_wireTap1" uri="direct:gen_log"/>
            <process id="_process1" ref="killRoute"/>
            <bean id="_bean1" method="generatePayload('astraPay')" ref="generatePayload"/>
            <to id="_to1" uri="direct:gen_sign"/>
            <marshal id="_marshal1" ref="jackson"/>
            <!--        		Checkpoint request payload ready to send to backend -->
            <wireTap id="_wireTap2" uri="direct:gen_log"/>
            <log id="_log2" message=">>>> Request Body to Backend: \n${body}"/>
            <removeHeaders id="_removeHeaders1" pattern="Camel*"/>
            <setHeader headerName="CamelHttpMethod" id="_setHeader1">
                <constant>POST</constant>
            </setHeader>
            <setHeader headerName="CamelHttpPath" id="_setHeader2">
                <simple>/welab-sun/api/credit/signPage</simple>
            </setHeader>
            <setHeader headerName="Content-Type" id="_setHeader3">
                <constant>application/json</constant>
            </setHeader>
            <to id="_to2" uri="https4://{{bs.env}}?bridgeEndpoint=true&amp;connectionClose=true&amp;throwExceptionOnFailure=false"/>
            <unmarshal id="_unmarshal1" ref="jackson"/>
            <!-- 			Checkpoint response received -->
            <wireTap id="_wireTap3" uri="direct:gen_log"/>
        </route>
    </routeContext>
</beans>
